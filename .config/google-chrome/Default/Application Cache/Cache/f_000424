qo.prototype.vw=$(92,function(a){return H(this,2,a)});M1a.prototype.vw=$(91,function(){return H(this,3)});N1a.prototype.vw=$(90,function(){return H(this,2)});function cvb(a){return""+Wpb(dw(a,{hca:"docs-icon-close-small"}))}
function dvb(a){return"<div"+(a.id?' id="'+X(a.id)+'"':"")+' class="'+(a.Je?X(a.Je)+" ":"")+'goog-flat-menu-button goog-flat-menu-button-disabled goog-inline-block" role="button" '+(a.Zo?'aria-label="'+X(a.Zo)+'"':"")+'><div class="goog-flat-menu-button-caption goog-inline-block">'+nw(a.Pr)+'</div><div class="goog-flat-menu-button-dropdown goog-inline-block" aria-hidden="true">&nbsp;</div>'+(a.Cj?nw(a.Cj):"")+"</div>"}
function evb(a,b){for(var c={},d=0;d<b.length;d++)c[b[d]]=!0;for(var e=[],d=0;d<a.length;d++)c[a[d]]||e.push(a[d]);return e}function fvb(){this.LT=this.jm=null}fvb.prototype.Sa=function(){return new DF(this.jm||void 0,void 0,!0,this.LT||rL.getInstance())};function gvb(a,b){vK.call(this);this.ba=a;this.j[a]=b}z(gvb,vK);gvb.prototype.k=function(a){var b={};b[this.ba]=a;wK(this,b)};function s_(){AO.call(this);this.j={};CO(this,new zO(BO,{},{wordList:[]}))}z(s_,AO);ka(s_);s_.prototype.k=function(a){hvb(this,a,!0)};function hvb(a,b,c){var d=!!a.j[b.toLowerCase()],e=b.toLowerCase();a.j[e]=!0;if(!d){var f={};f.value=e;DO(a).get("wordList").push(f);c&&ivb(a,[b],[])}return!d}s_.prototype.q=function(a){jvb(this,a,!0)};
function jvb(a,b,c){var d=!!a.j[b.toLowerCase()];if(d){var e=b.toLowerCase();delete a.j[e];for(var f=DO(a).get("wordList"),h=0;h<f.length;h++)if(f[h].value===e){f.splice(h,1);break}c&&ivb(a,[],[b])}return d}s_.prototype.o=function(a){a=a.get("wordList");for(var b=0;b<a.length;b++)hvb(this,a[b].value,!1);a.length&&this.dispatchEvent("userDictionaryChange")};
function ivb(a,b,c){var d={};d.dictSAdd=b;d.dictSRemove=c;a.dispatchEvent("userDictionaryChange");a.dispatchEvent(new FO(a,new EO("docs-user_dictionary",d),DO(a)))};function t_(a,b,c){Dv.call(this,a,b,c);fm(this,"Preferences")}z(t_,Dv);r=t_.prototype;r.ea=function(){t_.H.ea.call(this);T(this).F(this,"dialogselect",this.p9a)};r.setVisible=function(a){t_.H.setVisible.call(this,a);a&&this.update()};r.update=ja;r.p9a=function(a){"ok"==a.key&&this.yza()};r.yza=ja;function kvb(a){return a=""+('<div class="docs-userdictionarydialog-content"><div class="docs-userdictionarydialog-top-container"><div><input class="docs-userdictionarydialog-input jfk-textinput" type="text" aria-label="'+X(a.Tta)+'" placeholder="'+X(a.Tta)+'"></div><div class="docs-userdictionarydialog-button-add-container">'+RD({pe:"docs-userdictionarydialog-button-add",style:0,Hf:"Add"})+'</div></div><div class="docs-userdictionarydialog-list-container"></div></div>')};function lvb(a){return'<div class="docs-userdictionarydialog-row-container" role="option"><div title="'+X(a.MG)+'" class="docs-userdictionarydialog-row-content">'+X(a.MG)+"</div></div>"};function u_(a,b){yA.call(this,void 0,new mvb);this.U9=a;this.k=b}z(u_,yA);u_.prototype.Oo=ba();u_.prototype.ZI=function(a){a.relatedTarget&&Eh(this.k,a.relatedTarget)||u_.H.ZI.call(this,a)};u_.prototype.ij=function(a){return(46==a.keyCode||8==a.keyCode)&&this.Qi(a)};function mvb(){}z(mvb,sA);mvb.prototype.Mb=p("docs-userdictionarydialog-row-container");mvb.prototype.ah=function(a){return Qv(lvb,{MG:a.U9})};function v_(a){IC.call(this,void 0,new nvb);this.q=a;this.k=this.B=null}z(v_,IC);r=v_.prototype;r.ea=function(){v_.H.ea.call(this);hl(this.aa,"Personal dictionary entries.  Press DELETE or BACKSPACE to remove words from the dictionary.");cl(this.aa,"listbox");var a=this.B;Q(a,!1);Yj(a,!0);this.k=new qw(a);T(this).F(this,"action",this.y8).F(this.B,"click",this.y8).F(this.k,"key",this.XZa)};r.pd=function(){v_.H.pd.call(this);N(this.k);this.k=null};
function ovb(a){var b=[];a.Vf(function(a){b.push(a.U9)});return b}r.y8=function(){var a;a=MC(this);var b=this.Ir()==this.Wb()-1;OC(this);this.removeChild(a,!0);b||PC(this);pvb(this);this.dispatchEvent("change")};r.XZa=function(a){return 13==a.keyCode||32==a.keyCode?(this.y8(),a.preventDefault(),a.stopPropagation(),!0):!1};r.XD=function(){0==Tl(this,"docs-userdictionarydialog-row-container-hover").length&&NC(this)};r.Fw=function(a){a.stopPropagation();a.preventDefault()};
r.ji=function(a){return 27==a.keyCode?!1:v_.H.ji.call(this,a)};r.nQ=function(a){v_.H.nQ.call(this,a);pvb(this)};r.Kaa=function(a){var b=Nh(document);v_.H.Kaa.call(this,a);b&&jl(b,"docs-userdictionarydialog-list-remove-button")?this.aa.focus():pvb(this)};function pvb(a){if(MC(a)){var b;b=MC(a);var c=Math.round((Uj(b.aa).height-Uj(a.B).height)/2);a.B.style.top=Hj(b.aa).y+c+"px";hl(a.B,"Remove "+b.U9);Q(a.B,!0)}else Q(a.B,!1)}function nvb(){this.j=void 0}z(nvb,GC);
nvb.prototype.Ro=function(a){var b=Qv(cvb,{enabled:!0,Je:"docs-userdictionarydialog-list-remove-button"});a.B=b;a.getElement().appendChild(b)};function w_(a,b,c,d){t_.call(this,b,c,d);this.I=a;this.C=new SD(null,d);this.va(this.C);this.tc=this.q=null;this.D=new v_(a);this.va(this.D);this.G=null;fm(this,"Personal dictionary");a=rm((new mm).set("ok","Save",!0),tm,!1,!0);pm(this,a)}z(w_,t_);r=w_.prototype;r.Ma=function(){w_.H.Ma.call(this);Ov(this.kb(),kvb,{Tta:"Add a new word"});TH(this,"ok");this.C.Va(Ul(this,"docs-userdictionarydialog-button-add"));this.D.Va(Ul(this,"docs-userdictionarydialog-list-container"));this.q=Ul(this,"docs-userdictionarydialog-input")};
r.ea=function(){w_.H.ea.call(this);this.C.Z(!1);this.tc=new CD(this.q);T(this).F(this.C,"action",this.oRa).F(this.q,"keypress",this.qRa).F(this.tc,"input",this.nRa).F(this.D,"change",this.pRa);T(this).F(this.C.getElement(),"focus",this.j6).F(this.q,"focus",this.j6);for(var a=this.k.aa.getElementsByTagName("BUTTON"),b=0;b<a.length;b++)T(this).F(a[b],"focus",this.j6);this.G=new dK(this.D)};r.pd=function(){w_.H.pd.call(this);tg(this.tc,this.G);this.G=this.tc=null};r.oRa=function(){qvb(this)};r.nRa=function(){this.C.Z(!Oa(this.q.value))};
r.qRa=function(a){13==a.keyCode&&(this.C.isEnabled()&&qvb(this),a.stopPropagation(),a.preventDefault())};r.j6=function(){this.D.Ci(-1)};r.pRa=function(){qm(this.k,"ok").disabled=!1};r.update=function(){var a=this.D;a.Gd(!0);var b=Bc(a.q.j);b.sort(zqb());for(var c=0;c<b.length;c++)a.va(new u_(b[c],a.B),!0);rvb(this,"");qm(this.k,"ok").disabled=!0};
r.yza=function(){for(var a=this.D,b=Bc(a.q.j),c=ovb(a),a=evb(c,b),b=evb(b,c),c=this.I,d=[],e=[],f=0;f<a.length;f++)hvb(c,a[f],!1)&&d.push(a[f]);for(f=0;f<b.length;f++)jvb(c,b[f],!1)&&e.push(b[f]);(0<d.length||0<e.length)&&ivb(c,d,e)};r.setVisible=function(a){w_.H.setVisible.call(this,a);a&&(a=this.q)&&(a.focus(),yBa(a,a.value.length))};function rvb(a,b,c){a.q.value=b;a.C.Z(!Oa(a.q.value));c&&a.q.select()}
function qvb(a){var b=a.D,c=a.q.value,c=c.toLowerCase().trim();-1==ovb(b).indexOf(c)&&(c=new u_(c,b.B),b.qk(c,0,!0),b.aa.scrollTop=0,b.dispatchEvent("change"));BV(a.Q())==a.q&&a.q.blur();rvb(a,"");a.q.focus()};function svb(a,b){var c=new w_(s_.getInstance());a.li(c);return ya(tvb,c,b)}function tvb(a,b,c){a.setVisible(!0);b().setVisible(!1);c&&rvb(a,c,!0)};function uvb(){P.call(this);this.j=new Xc}z(uvb,P);function vvb(a,b,c,d,e,f,h,k){this.j=a;this.D=b instanceof Element?Yb(b):b;this.Oa=c;this.G=d;this.k=e;this.o=f;this.q=h;this.B=k||null;this.M=new R(this);L(this,this.M)}z(vvb,K);r=vvb.prototype;r.LIa=function(a){var b=this.k.j;wvb(this.o,a);x_(this,b,!0)};
r.MIa=function(a){var b=this.k.j,c=this.o,d=$a(a.us().getOriginalWord()),e=a.k;a=new lt;I(a,1,"\\b"+d+"\\b");I(a,3,e);I(a,6,!1);I(a,7,!1);I(a,8,!0);a.nd(2);I(a,11,0);var f,d=c.j.k;switch(c.j.I){case "RANGE":I(a,5,0);f=gt(d.rect,d.yc);I(a,9,f);f=Vw(c.k,d.yc);break;case "SHEET":I(a,5,1);f=new Go;I(f,1,""+d.yc);I(a,9,f);f=Vw(c.k,d.yc);break;case "WORKBOOK":I(a,5,2),f=c.k.MS(-1,0,!1)}c.Pa.Ob(new XY(f.Zb(),0,a));x_(this,b,!0)};
r.OIa=function(a){var b=this.k.j;if(a){var c=this.G;c.j.contains(a.toLowerCase())||(c.j.add(a.toLowerCase()),c.dispatchEvent("ignoreWhitelistChange"))}x_(this,b,!1)};r.NIa=function(a){var b=this.k.j;if(a){var c=this.o.o,d=a.us().getOriginalWord(),e=a.getSelection();if(!xvb(c,d,e)){a=c.Zc[""+e.yc];a||(a=Kn(c.j,e.yc),a.getSheetType(),a=new ax(a.Zb(),!0),c.Zc[""+e.yc]=a);var c=e.Nb.y,e=e.Nb.x,f=a.Pd(c,e);f||(f=new Xc,bx(a,c,e,f));f.add(d.toLowerCase())}}x_(this,b,!1)};
r.PIa=function(a){var b=this.k.j;a&&(yd(Bd(),"docs-spell-erfd")&&this.B?this.B.k(a):s_.getInstance().k(a));x_(this,b,!1)};r.Tfa=function(){U.E0.Ed(!1);this.M.wc(this.j,"close",this.Tfa);isa(Ev.getInstance())||this.Oa.ib(3);yvb(this.o.j);if(!U.ki.isEnabled()){var a=Iq.getInstance(),b=Kq("Spellcheck will be unavailable until you reconnect.","info",!0,1E4);a.postMessage(b)}};
r.Uia=function(a){var b=this.j;Q(b.Da,!1);Q(b.$a,!0);var b=this.k,c=y(this.Wla,this,this.k.j,!1);this.q.dm().getSelection();b.j&&(a?b.q.unshift(b.j):b.L.push(b.j));zvb(b,c,!!a)};function x_(a,b,c){var d=a.j;Q(d.Da,!1);Q(d.$a,!0);b=y(a.Wla,a,b,c);a.q.dm().getSelection();zvb(a.k,b,!1)}
r.Wla=function(a,b){this.j.setVisible(!0);var c=this.j;Q(c.Da,!0);Q(c.$a,!1);var c=this.k.j,d=this.j,e=this.I,f=this.C;Xg(d.Cc);var h=Qh(d.Q(),"docs-slidingdialog-content",d.getElement());h&&dl(h,"label",c?"Spellcheck":"No spelling suggestions");if(c){e=c.us();f=d.Q();T(d).wc(d.B,"focus",d.Jfa).wc(d.B,"blur",d.Ifa).wc(d.L,"input",d.Lfa).wc(d.B,"keydown",d.Kfa);d.C.Ta("");var h=d.B,k=f.tg(f.cDa(h));wh(k,h);d.B=f.getElement("docs-spellcheckslidingdialog-replacement-input");if(!d.B)throw Error("Replacement input not in DOM.");
N(d.removeChild(d.C));d.C=new XV("",f);d.va(d.C);d.C.Va(d.B);N(d.L);d.L=new CD(d.B);for(T(d).F(d.B,"focus",d.Jfa).F(d.B,"blur",d.Ifa).F(d.L,"input",d.Lfa).F(d.B,"keydown",d.Kfa);0<d.q.Wb();)d.q.jo(0).dispose();f="Next misspelling. Change "+(e.getOriginalWord()+" to:");dl(d.B,"label",f);d.Q().vh(d.bh,e.getOriginalWord());f=e.j;if(0==f.length)d.C.Ta(e.getOriginalWord()),k=new YC("No suggestions"),d.q.va(k,!0),k.hf(2,!1),k.Z(!1),d.rf.k(!1);else{d.C.Ta(f[0]);for(h=0;h<f.length;h++)k=new YC(f[h]),d.q.va(k,
!0),T(d).F(k,"action",d.eDa).F(k.getElement(),"dblclick",d.dDa),1<f.length&&(k.hp(!0),k=hh("goog-menuitem-checkbox",k.aa),kl(k,"goog-inline-block"));(f=d.q.xc(0))&&1<d.q.Wb()&&f.mc(!0);d.q.Ci(0);d.rf.k(!0)}Tpb(d.xb,c.getSelection());d.gDa.call(d,e,-1);Avb(d.I);d.fDa.call(d,-1);Avb(d.P);Q(d.oc,!1);Q(d.Jb,!0)}else Q(d.Jb,!1),sh(d.we),e&&d.we.appendChild(e),Q(d.oc,!0),e=u(f)?f:5E3,d.Cc=Wg(y(d.vo,d),e),d.xb.nu();this.j.focus();c?Bvb(this.o,c.getSelection()):b&&Bvb(this.o)};function Cvb(a,b){this.k=a;this.j=b}Cvb.prototype.us=g("j");function Dvb(a,b,c){this.j=a;this.o=b;this.k=c||null}Dvb.prototype.getOriginalWord=g("o");function y_(a,b,c,d,e){CY.call(this,e);this.G=a;this.D=b;this.xb=new BY(c);this.va(this.xb);this.sa=new SD(null,e);this.va(this.sa);this.P=new cD(e);this.Af=new ZJ(null,this.P,AP.getInstance());this.va(this.Af);this.Ab=new SD(null,e);this.va(this.Ab);this.I=new cD(e);this.dh=new ZJ(null,this.I,AP.getInstance());this.va(this.dh);this.Fd=this.Ba=this.V=null;this.C=new XV("",e);this.va(this.C);this.q=new Evb(e);dD(this.q,!1);this.va(this.q);this.Cc=this.bh=this.we=this.oc=this.Jb=this.L=this.B=null;
this.rf=d;this.Da=this.$a=this.qb=null}z(y_,CY);function Avb(a){ll(a.aa,["goog-menu-no-icon","goog-menu-noaccel"])}r=y_.prototype;
r.nba=function(){var a=yd(xd.getInstance(),"docs-spell-erfd"),b="",c;c=""+('<div id="docs-spellcheckslidingdialog-loading"><div class="docs.spellcheckslidingdialog-loading-text">Loading spelling suggestions...</div><div class="docs-spellcheckslidingdialog-loading-spinner">'+Vpb()+'</div></div><div id="docs-spellcheckslidingdialog-content"><div id="docs-spellcheckslidingdialog-no-misspellings" tabindex="-1"><div class="docs-spellcheckslidingdialog-title-text docs-spellcheckslidingdialog-no-misspellings">No spelling suggestions</div><div id="docs-spellcheckslidingdialog-no-misspellings-footer"></div></div><div id="docs-spellcheckslidingdialog-misspellings"><label class="docs-spellcheckslidingdialog-title-text goog-inline-block">Change <span id="docs-spellcheckslidingdialog-original-word"></span> to:</label><div class="docs-spellcheckslidingdialog-container"><table cellspacing="0" role="presentation"><tbody><tr><td class="docs-spellcheckslidingdialog-replacement-input-container"><input id="docs-spellcheckslidingdialog-replacement-input" autocomplete="off" type="text" class="docs-spellcheckslidingdialog-replacement-input" spellcheck="false"></input>'+Upb({id:"docs-spellcheckslidingdialog-replacement-context"})+
"</td><td>"+RD({id:"docs-spellcheckslidingdialog-button-change",style:2,pe:"docs-spellcheckslidingdialog-buttons-action",Hf:"Change"})+dvb({id:"docs-spellcheckslidingdialog-button-change-menu",Pr:""})+'</td></tr><tr><td><div id="docs-spellcheckslidingdialog-suggestion-list"></div></td><td id="docs-spellcheckslidingdialog-ignore-buttons">'+RD({id:"docs-spellcheckslidingdialog-button-ignore",style:0,pe:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",Hf:"Ignore"})+
dvb({id:"docs-spellcheckslidingdialog-button-ignore-menu",Je:"docs-spellcheckslidingdialog-buttons-white-menu",Pr:""}));a&&(c+="<br/>"+RD({id:"docs-spellcheckslidingdialog-button-dictionary",style:0,pe:"docs-spellcheckslidingdialog-buttons-action docs-spellcheckslidingdialog-buttons-white",Hf:"Add to Dictionary"})+dvb({id:"docs-spellcheckslidingdialog-button-dictionary-menu",Je:"docs-spellcheckslidingdialog-buttons-white-menu",Pr:""}));return a=b+Xpb({yxa:"Spellcheck",Hf:""+(c+"</td></tr></tbody></table></div></div></div>")})};
r.ea=function(){y_.H.ea.call(this);kl(this.aa,"docs-spellcheckslidingdialog");var a=this.Q();this.$a=a.getElement("docs-spellcheckslidingdialog-loading");this.Da=a.getElement("docs-spellcheckslidingdialog-content");this.oc=a.getElement("docs-spellcheckslidingdialog-no-misspellings");this.we=a.getElement("docs-spellcheckslidingdialog-no-misspellings-footer");this.Jb=a.getElement("docs-spellcheckslidingdialog-misspellings");this.B=a.getElement("docs-spellcheckslidingdialog-replacement-input");this.L=
new CD(this.B);this.bh=a.getElement("docs-spellcheckslidingdialog-original-word");this.xb.Va(a.getElement("docs-spellcheckslidingdialog-replacement-context"));this.C.Va(this.B);this.sa.Va(a.getElement("docs-spellcheckslidingdialog-button-change"));this.Ab.Va(a.getElement("docs-spellcheckslidingdialog-button-ignore"));Fvb(this.Af,this.sa,"docs-spellcheckslidingdialog-button-change-menu",U.kda,this.G,a);Fvb(this.dh,this.Ab,"docs-spellcheckslidingdialog-button-ignore-menu",U.mda,this.G,a);this.q.Va(a.getElement("docs-spellcheckslidingdialog-suggestion-list"));
QC(this.q,!0);Avb(this.q);IF(this.G,this.Ab,U.k_,JF,y(this.D.$,this.D));IF(this.G,this.sa,U.eR,JF,y(this.sSa,this));if(yd(xd.getInstance(),"docs-spell-erfd")){kl(this.getElement(),"docs-spellcheckslidingdialog-dictionary-flag");this.V=new SD(null,this.Q());this.Ba=new cD(a);this.Fd=new ZJ(null,this.Ba,AP.getInstance(),a);this.va(this.V);this.va(this.Fd);this.V.Va(a.getElement("docs-spellcheckslidingdialog-button-dictionary"));Gvb(this,this.V,U.fR,!0);Fvb(this.Fd,this.V,"docs-spellcheckslidingdialog-button-dictionary-menu",
U.lda,this.G,a);var a=new YC("View personal dictionary..."),b=Jc(JF);delete b.label;IF(this.G,a,U.Pt,b,y(this.UV,this,this.D));this.Ba.va(a,!0);Avb(this.Ba)}T(this).F(this.q.getElement(),D?uda:"focus",this.tSa);this.qb=new ggb(this.getElement());L(this,this.qb);a=Nfb("Ctrl+single-quote",!1);b=Nfb("Ctrl+semicolon",!1);Ufb(this.qb,U.l_,a);Ufb(this.qb,U.m_,b)};r.focus=function(){Xj(this.Jb)?this.C.Bj():this.oc.focus()};
function Fvb(a,b,c,d,e,f){c=f.getElement(c);a.Va(c);YX(a,1);jfb(a,b.getElement());YX(b,2);if(b=new NA(c,a.Rd()?1:3))a.G=b,a.sa=b.element;IF(e,a,d,JF)}r.fDa=function(a){for(;0<this.P.Wb();)this.P.jo(0).dispose();var b=lh("span","docs-spellcheckslidingdialog-menu-text","Change all");a=lh("span","docs-spellcheckslidingdialog-count",0>a?"":"("+(a+" found)"));var c=[];c.push(b);c.push(a);b=new YC(c);IF(this.G,b,U.u_,void 0,y(this.I$a,this));this.P.va(b,!0)};
r.gDa=function(a,b){for(;0<this.I.Wb();)this.I.jo(0).dispose();var c=lh("span","docs-spellcheckslidingdialog-menu-text","Ignore all"),d=lh("span","docs-spellcheckslidingdialog-count",0>b?"":"("+(b+" found)")),e=[];e.push(c);e.push(d);c=new YC(e);Gvb(this,c,U.v_,!1);this.I.va(c,!0);yd(xd.getInstance(),"docs-spell-erfd")||(c=a.getOriginalWord(),c=new YC('Add "'+(c+'" to dictionary')),Gvb(this,c,U.fR,!1),this.I.va(c,!0))};function Hvb(a){var b=a.C.X();a=new Dvb(b,a.UV(a.D),a.D);U.eR.fireAction(a)}
r.dDa=function(){Hvb(this)};r.Jfa=function(){var a=this.Q().UP(this.B);kl(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};r.Ifa=function(){var a=this.Q().UP(this.B);ml(a,"docs-spellcheckslidingdialog-replacement-input-container-focus")};r.Kfa=function(a){13==a.keyCode&&Hvb(this)};r.tSa=function(){for(var a=0;a<this.q.Wb();a++){var b=this.q.xc(a);if(b.Uc()){b.Ng(!0);return}}0<this.q.Wb()&&this.q.Ci(0)};function Ivb(a){for(var b=0;b<a.q.Wb();b++)a.q.xc(b).mc(!1)}
r.Lfa=function(){Ivb(this);this.rf.k(!0)};r.eDa=function(a){var b=a.target.X();Ivb(this);this.C.Ta(b);(a=a.target)&&1<this.q.Wb()&&a.mc(!0);this.C.Bj()};r.sSa=function(){var a=this.C.X();return new Dvb(a,this.UV(this.D),this.D)};r.I$a=function(){var a=this.D,a=a.j?a.j.us():null;return new Cvb(this.C.X(),a)};function Gvb(a,b,c,d){IF(a.G,b,c,d?JF:void 0,y(a.UV,a,a.D))}r.UV=function(a){return(a=a.j)?a.us().getOriginalWord():null};r.J=function(){Xg(this.Cc);N(this.L);y_.H.J.call(this)};
function Evb(a,b){cD.call(this,a,b)}z(Evb,cD);Evb.prototype.ji=function(a){return 27==a.keyCode?!1:Evb.H.ji.call(this,a)};function Jvb(a){var b="";a='<b>"'+(X(a.MG)+'"</b> added to your personal dictionary.');return Wv(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))}function Kvb(a){var b="";a='<b>"'+(X(a.MG)+'"</b> removed from your personal dictionary.');return Wv(b+('<span class="docs-userdictionary-butterbar-item">'+a+"</span>"))};function Lvb(a,b){this.B=a;this.j=b;this.o=0}Lvb.prototype.k=function(a){this.B.k(a);yd(Bd(),"docs-spell-erfd")&&(a=Mq(Qv(Jvb,{MG:a}),U.Ap.mi(),y(this.q,this,a),"info",!0,1E4),Jq(this.j,this.o),this.o=this.j.postMessage(a))};Lvb.prototype.q=function(a){this.B.q(a);yd(Bd(),"docs-spell-erfd")&&(a=Mq(Qv(Kvb,{MG:a}),U.Ap.mi(),y(this.k,this,a),"info",!0,1E4),Jq(this.j,this.o),this.o=this.j.postMessage(a))};function Mvb(a){K.call(this);this.j=a;this.Zc={};this.Y=new R(this);L(this,this.Y);this.Y.F(a,"k",this.k)}z(Mvb,K);function xvb(a,b,c){if(a=a.Zc[""+c.yc])if(c=a.Pd(c.Nb.y,c.Nb.x))return!!c.contains(b.toLowerCase());return!1}Mvb.prototype.k=function(a){N(this.Zc[""+a.Lg]);delete this.Zc[""+a.Lg]};function z_(){F.apply(this)}z(z_,F);z_.prototype.Ff=function(){return H(this,2)};z_.prototype.rangeCount=function(){return Mf(this,2)};function A_(){F.apply(this)}z(A_,F);A_.prototype.ob=function(){return H(this,1)};function Nvb(){F.apply(this)}z(Nvb,F);function Ovb(){F.apply(this)}z(Ovb,F);Ovb.prototype.vw=function(){return H(this,2)};function Pvb(){F.apply(this)}z(Pvb,F);Pvb.prototype.getOriginalWord=function(){return H(this,1)};
J(z_,{0:{name:"SpellcheckRequest",Na:"ritzproto.SpellcheckRequest"},1:{name:"start_searching_column",K:5,type:Number},2:{name:"range",K:11,type:Go},3:{name:"search_all_sheets",K:8,type:Boolean},4:{name:"active_filter_views",bc:!0,K:11,type:A_}});J(A_,{0:{name:"FilterViewData",Na:"ritzproto.FilterViewData"},1:{name:"grid_id",K:9,type:String},2:{name:"filter_view_id",K:9,type:String}});
J(Nvb,{0:{name:"SpellcheckResponse",Na:"ritzproto.SpellcheckResponse"},1:{name:"last_row_searched",K:5,type:Number},2:{name:"last_column_searched",K:5,type:Number},3:{name:"last_grid_id_searched",K:9,type:String},4:{name:"searched_all_sheets",K:8,type:Boolean},6:{name:"searched_whole_range",K:8,type:Boolean},5:{name:"cell_suggestions",bc:!0,K:11,type:Ovb}});J(Ovb,{0:{name:"CellSuggestions",Na:"ritzproto.CellSuggestions"},1:{name:"phrase_suggestions",bc:!0,K:11,type:Pvb},2:{name:"cell",K:11,type:Nn}});
J(Pvb,{0:{name:"PhraseSuggestions",Na:"ritzproto.PhraseSuggestions"},1:{name:"original_word",K:9,type:String},2:{name:"offset_start_index",K:5,type:Number},3:{name:"offset_end_index",K:5,type:Number},4:{name:"suggestions",bc:!0,K:9,type:String}});function Qvb(a,b){this.j=a;this.k=b}Qvb.prototype.equals=function(a){return this.j.equals(a.us())&&this.k.equals(a.getSelection())};Qvb.prototype.us=g("j");Qvb.prototype.getSelection=g("k");function Rvb(a,b){this.k=a;this.j=b}Rvb.prototype.getOriginalWord=g("k");Rvb.prototype.equals=function(a){var b=a.getOriginalWord();a=a.j;return this.k==b&&Tb(this.j,a)};function Svb(a,b,c){this.Nb=a;this.yc=b;this.ze=c}Svb.prototype.equals=function(a){if(this===a)a=!0;else if(a instanceof Svb){var b;if(b=bf(a.Nb,this.Nb)&&a.yc==this.yc)a=a.ze,b=this.ze,b=a==b?!0:a&&b?a.start==b.start&&a.end==b.end:!1;a=b}else a=!1;return a};function B_(a,b,c,d,e){this.B=a;this.sa=b;this.Ba=c;this.Ha=d;this.ua=e;this.C=this.o=this.j=null;this.G=!1;this.q=[];this.L=[];this.Y=new R(this);L(this,this.Y);this.D=null;this.I="RANGE";this.P=new Fn;this.P.QK=!0;this.R=new Fn;this.R.QK=!1}z(B_,K);B_.prototype.$=g("j");
function yvb(a,b,c){CC(a.D);a.Y.Eb();a.I=b;a.k=c;switch(b){case "WORKBOOK":a.o=new E(-1,0);a.C=""+a.B.MS(-1,0,!1,!0).cb();break;case "SHEET":a.o=new E(-1,0);a.C=""+c.yc;break;case "RANGE":a.o=new E(c.rect.left-1,c.rect.top),a.C=""+c.yc}a.G=!1;a.q=[];a.L=[]}function Tvb(a,b){var c=b.us().getOriginalWord(),d=b.getSelection().ze;return Uvb(a,b).substring(d.start,d.end)==c}function Uvb(a,b){var c=Vvb(a,b);return Fa(c,"'")?c.substring(1):c}function Wvb(a,b){var c=Vvb(a,b);return Fa(c,"'")}
function Vvb(a,b){var c=b.getSelection(),d=c.Nb,e=c.yc,f=Vw(a.B,e).Zb(),c=rf(c.Nb);f.yq(c);return f.getCellAt(d.y,d.x).getRawValue(e,d.y,d.x)}
function Xvb(a,b){var c=new z_,d=new Go;I(d,1,a.C);I(d,2,a.o.y);switch(a.I){case "WORKBOOK":I(c,3,!0);Io(d,0);for(var e=zJa(a.B),f=0;f<e.length;f++)if(0==e[f].getSheetType()){var h=e[f];Yvb(c,h)}break;case "SHEET":Io(d,0);h=Vw(a.B,a.k.yc);Yvb(c,h);break;case "RANGE":Io(d,a.k.rect.sb()),Ho(d,a.k.rect.Gb()),Jo(d,a.k.rect.Qb()),h=Vw(a.B,a.k.yc),Yvb(c,h)}I(c,2,d);I(c,1,a.o.x+1);lq(oq(mq(kq(a.sa.Xe("/spell"),{data:a.P.cc(c)})),function(a){this.Fk(a,!0,b)},a),function(a){this.Fk(a,!1,b)},a).ae()}
function Yvb(a,b){if(b){var c=b.Zb().j;if(ox(c)){var d=""+b.cb(),c=c.getActiveFilterId(),e=new A_;I(e,1,d);I(e,2,c);Nf(a,4,e)}}}
B_.prototype.Fk=function(a,b,c){if(b)for(a=this.R.Dd(Nvb.kd(),a.wf()),this.o=new E(H(a,2),H(a,1)),this.C=H(a,3),this.G=H(a,6),a=Qf(a,5),b=0;b<a.length;b++)for(var d=a[b],e=d.vw().getRowIndex(),f=d.vw().getColumnIndex(),e=new E(f,e),f=parseInt(d.vw().cb(),10),d=Qf(d,1),h=0;h<d.length;h++){var k=d[h],l=k.getOriginalWord(),m=H(k,2),n=H(k,3),m=new Svb(e,f,new ff(m,n));Zvb(this,l,m)||(k=Qf(k,4),this.q.push(new Qvb(new Rvb(l,k),m)))}zvb(this,c,!1)};
function zvb(a,b,c){var d,e;c?(d=a.L,e=y(d.pop,d)):(d=a.q,e=y(d.shift,d));for(;0<d.length;){var f=e(),h=f.us().getOriginalWord();if(!Zvb(a,h,f.getSelection())){e=c;h=f.getSelection();c=Vw(a.B,h.yc);d=c.Zb();h=rf(h.Nb);f=y(a.V,a,f,b,e);d.yq(h)?f():Oe?(CC(a.D),a.D=ls(c.ug,h).addCallback(f)):(a.Y.Eb(),ns(c.ug,h,f,a.Y));return}}a.G||c?(a.j=null,b(null)):Xvb(a,b)}B_.prototype.V=function(a,b,c){Tvb(this,a)?(this.j=a,b(a.us())):zvb(this,b,c)};
function Zvb(a,b,c){return a.Ha.j.contains(b.toLowerCase())||xvb(a.ua,b,c)||!!a.Ba.j[b.toLowerCase()]}B_.prototype.J=function(){B_.H.J.call(this);CC(this.D)};function $vb(a,b,c,d){this.k=a;this.Pa=b;this.j=c;this.o=d}
function wvb(a,b){var c=b.k.j;if(Tvb(a.j,c)){var d=c.getSelection(),e=d.yc,f=d.ze,h=Vw(a.k,e).Zb(),k=Wvb(a.j,c),c=Uvb(a.j,c),f=(k?"'":"")+c.substring(0,f.start)+b.j+c.substring(f.end),l=new HB(h,rf(d.Nb),f);Ola(l,y(function(a){if(a){a=this.j;for(var c=b.j,e=0;e<a.q.length;e++){var f=a.q[e].getSelection();if(bf(f.Nb,d.Nb)&&f.yc==d.yc&&f.ze.start>d.ze.end){var h=d.ze,h=h.end-h.start-c.length;f.ze.start-=h;f.ze.end-=h}}}},a));e=new ct(e,"",rf(d.Nb));TX(a.k,e,y(function(){this.Pa.Ob(l)},a))}}
function Bvb(a,b){if(b){var c=new ct(b.yc,"",rf(b.Nb));TX(a.k,c)}};function awb(a){this.Hm=new Spb(a)}awb.prototype.k=function(a){var b=new yp,c=new Go;I(c,2,a.Nb.x);Ho(c,a.Nb.x+1);Io(c,a.Nb.y);Jo(c,a.Nb.y+1);I(c,1,""+a.yc);Nf(b,2,c);c=new Nn;I(c,1,""+a.yc);c.Qq(a.Nb.x);I(c,3,a.Nb.y);I(b,1,c);return this.Hm.k(new iR(b))};function bwb(a,b,c,d,e,f,h){AY.call(this,"docs-spellcheckslidingdialog-id",c,y(this.j3,this));this.Pa=b;this.L=a;this.V=new Lvb(s_.getInstance(),Iq.getInstance());this.I=new uvb;this.G=new Mvb(a);this.q=new B_(a,e,s_.getInstance(),this.I,this.G);this.$=new $vb(a,b,this.q,this.G);this.D=new y_((new fvb).Sa(),this.q,new awb(a),new gvb("trigger-text",!1));this.k=new vvb(this.D,y(this.KIa,this),c,this.I,this.q,this.$,d,this.V);a=Yg();this.o=a.U("div",{style:"margin-top: 10px"});this.B=UD("Search the rest of the sheet",
a);this.B.render(this.o);this.Y.F(this.B,"action",this.QIa);this.C=UD("Search all sheets",a);this.C.render(this.o);this.Y.F(this.C,"action",y(this.j3,this,"WORKBOOK"));GO(h,s_.getInstance(),"docs-user_dictionary");U.k_.Ua("action",this.k.NIa,this.k);U.v_.Ua("action",this.k.OIa,this.k);U.fR.Ua("action",this.k.PIa,this.k);U.eR.Ua("action",this.k.LIa,this.k);U.u_.Ua("action",this.k.MIa,this.k);U.l_.Ua("action",y(this.k.Uia,this.k,!1));U.m_.Ua("action",y(this.k.Uia,this.k,!0));yd(xd.getInstance(),"docs-spell-erfd")?
(U.Pt.setVisible(!0),U.Pt.Ua("action",svb(f,Yb(this.D)))):(U.Pt.setVisible(!1),U.Pt.Z(!1))}z(bwb,AY);r=bwb.prototype;r.XX=g("D");r.Lv=function(){bwb.H.Lv.call(this);this.Y.F(this.j,"close",this.TYa).F(this.L,"sheet-view-obscured",this.UYa)};r.TYa=function(){this.fC()};r.UYa=function(){this.j.vo();this.fC()};
r.j3=function(a,b){var c=a,d=b||null,e;if(!c){var f=this.L.getActiveSheet();f?0==f.getSheetType()?(d=f.Zb().Ub(),1<Gf(d)?(c="RANGE",d=new ct(f.cb(),f.o,d)):(c="SHEET",d=new ct(f.cb(),f.o,null))):c="WORKBOOK":c="WORKBOOK"}"WORKBOOK"!=c&&(e=15E3);switch(c){case "RANGE":this.B.setVisible(!0);this.C.setVisible(!0);Q(this.o,!0);break;case "SHEET":this.B.setVisible(!1);this.C.setVisible(!0);Q(this.o,!0);break;case "WORKBOOK":Q(this.o,!1)}yvb(this.q,c,d);c=this.k;c.I=this.o;c.C=e;U.E0.Ed(!0);c.j.dc()||c.j.render(c.D());
(e=c.j.XA)&&c.k.j?c.j.focus():(e||c.M.F(c.j,"close",c.Tfa),x_(c,null,!1))};r.KIa=function(){return Yg().getElement(this.N9())};r.QIa=function(){var a=this.q.k;this.j3("SHEET",new ct(a.yc,a.jg,null))};function cwb(){K.call(this)}z(cwb,Mm);cwb.prototype.qb=function(a,b,c,d,e,f,h){return new bwb(a,b,c,d,e,f,h)};Ym("spellcheck",cwb);
